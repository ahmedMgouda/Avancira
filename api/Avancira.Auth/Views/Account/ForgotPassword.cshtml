@model ForgotPasswordViewModel
@{
    ViewData["Title"] = ViewData["Title"] ?? "Forgot Password";
}

@if (!string.IsNullOrEmpty(Model.Message))
{
    <p>@Model.Message</p>
}

<form asp-action="ForgotPassword" method="post">
    @Html.AntiForgeryToken()
    <div asp-validation-summary="ModelOnly"></div>
    <div>
        <label asp-for="Email"></label>
        <input asp-for="Email" type="email" />
        <span asp-validation-for="Email"></span>
    </div>
    <div id="cooldown-message" style="display:@(Model.RemainingCooldown > 0 ? "block" : "none")">
        Please wait <span id="cooldown-timer">@Model.RemainingCooldown</span> seconds before requesting another reset.
    </div>
    <button id="submitBtn" type="submit" @(Model.RemainingCooldown > 0 ? "disabled" : "")>Send password reset link</button>
</form>

<p><a asp-action="Login">Back to login</a></p>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        (function () {
            var cooldown = @Model.RemainingCooldown;
            if (cooldown > 0) {
                var btn = document.getElementById('submitBtn');
                var message = document.getElementById('cooldown-message');
                var timer = document.getElementById('cooldown-timer');
                btn.disabled = true;
                var interval = setInterval(function () {
                    cooldown--;
                    if (timer) timer.textContent = cooldown;
                    if (cooldown <= 0) {
                        clearInterval(interval);
                        if (message) message.style.display = 'none';
                        if (btn) btn.disabled = false;
                    }
                }, 1000);
            }
        })();
    </script>
}
